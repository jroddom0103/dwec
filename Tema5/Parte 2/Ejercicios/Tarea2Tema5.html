<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script>
        //Función autoinvocada
        (function menuFuncion() {

            //Declaración de variables
            var registro = {};
            var cesta = [];
            var valor;

            //Bucle del menú
            do {
                //Mostrar y recoger datos del menú
                valor = prompt("1. Ver cesta.\n 2. Insertar un artículo.\n 3. Borrar un artículo.\n 4. Vaciar cesta.\n 5. Salir.");
                if(valor==undefined){
                    alert("Cerrando.")
                    return;
                }else if (valor != '1' && valor != '2' && valor != '3' && valor != '4' && valor != '5') {
                    alert("Introdujiste un valor que no es válido.");
                }

                //Estructura de control switch
                switch (valor) {
                    //Mostrar cesta
                    case '1':
                        if(cesta.length==0){
                            alert("No hay artículos en la cesta.")
                        }else{
                            mostrarCesta(cesta);
                        }
                        break;
                    //Insertar artículo    
                    case '2':
                        insertarArticulo(registro,cesta);
                        break;
                    //Borrar artículo
                    case '3':
                        borrarArticulo(cesta);
                        break;
                    //Vaciar cesta    
                    case '4':
                        vaciarCesta(cesta);
                        break;
                    //Salir    
                    case '5':
                        alert("Cerrando.")
                        return;
                    case undefined:
                        return;    
                }

            } while (true);
        })()

        //Función mostrar cesta
        function mostrarCesta(cesta){
            var suma=0;
            var mensaje="Código | Nombre | Precio | Cantidad | Subtotal";
            cesta.forEach(articulo => {
                mensaje= mensaje+"\n"+articulo.Código+"     |     "+articulo.Nombre+"     |     "+articulo.Precio+"     |     "+articulo.Cantidad+"       |     "+articulo.Subtotal;
                suma = suma + articulo.Subtotal;
            });
            mensaje = mensaje+"\n                                                      Total |"+suma;
            alert(mensaje);

        }

        

        //Función borrar artículo
        function borrarArticulo(cesta){
            var codArtBorrado = prompt("Di el código del artículo que quieres eliminar:")
            if(codArtBorrado==undefined){
                return;
            }
            var viejoTamaño = cesta.length;
            //Si coincide con el código, se elimina
            for(i=0;i<cesta.length;i++){
                if(codArtBorrado==cesta[i].Código){
                    cesta.splice(i,1);
                }
            }
            //Si no coincide, mensaje
            if(viejoTamaño==cesta.length){
                alert("No se encontró el artículo.")
            }
        }

        //Función vaciar cesta
        function vaciarCesta(cesta){
            //Eliminar desde el primer elemento hasta el último
            cesta.splice(0,cesta.length);
        }

    </script>

</head>

<body>

</body>

</html>